
CREATE TABLE AH108_HRSR_RESTRICTED_ACCESS
(
    HRSR_REQUEST_CD      VARCHAR2(20) NOT NULL ,
    EMPLOYEE_PIN         VARCHAR2(20) NOT NULL ,
    DATE_RESTRICTED_START_DTE DATE NOT NULL ,
    DATE_RESTRICTED_END_DTE DATE NULL ,
    DATE_CREATED_DTE     DATE NULL ,
    DATE_LAST_UPDATE_DTE DATE NULL ,
    USER_LAST_UPDATE_ID  VARCHAR2(30) NULL ,
    DATE_DELETED_DTE     DATE NULL 
);

COMMENT ON TABLE AH108_HRSR_RESTRICTED_ACCESS IS 'A list of employees who will be retricted from viewing a specific HRSR (Human Resource Service Request). This may be due to conflict of interest reasons, etc.';

COMMENT ON COLUMN AH108_HRSR_RESTRICTED_ACCESS.HRSR_REQUEST_CD IS 'Foreign key to AH027_HRSR_REQUEST. A system generated Primary Key based on a defined algorithm in the following format: Year request started Hyphen (-) Sequential number.';

COMMENT ON COLUMN AH108_HRSR_RESTRICTED_ACCESS.EMPLOYEE_PIN IS 'Employee PIN who is restricted from viewing the HRSR. LEGACY COLUMN NAME.';

COMMENT ON COLUMN AH108_HRSR_RESTRICTED_ACCESS.DATE_RESTRICTED_START_DTE IS 'Start date of the restricted access to the HRSR.';

COMMENT ON COLUMN AH108_HRSR_RESTRICTED_ACCESS.DATE_RESTRICTED_END_DTE IS 'End date of the restricted access to the HRSR.';

COMMENT ON COLUMN AH108_HRSR_RESTRICTED_ACCESS.DATE_CREATED_DTE IS 'The date on which the data item was created and became available for use.';

COMMENT ON COLUMN AH108_HRSR_RESTRICTED_ACCESS.DATE_LAST_UPDATE_DTE IS 'The date the data item was last updated.';

COMMENT ON COLUMN AH108_HRSR_RESTRICTED_ACCESS.USER_LAST_UPDATE_ID IS 'The responsible user that affected the last change of the data record.';

COMMENT ON COLUMN AH108_HRSR_RESTRICTED_ACCESS.DATE_DELETED_DTE IS 'The date from which the data item is no longer allowed to be referenced for any new inserts or updates.
This can only happen for the current day or previous dates.';

CREATE UNIQUE INDEX AH108_PK ON AH108_HRSR_RESTRICTED_ACCESS
(HRSR_REQUEST_CD   ASC,EMPLOYEE_PIN   ASC,DATE_RESTRICTED_START_DTE   ASC);

CREATE INDEX AH108_IF1 ON AH108_HRSR_RESTRICTED_ACCESS
(HRSR_REQUEST_CD   ASC);

ALTER TABLE AH108_HRSR_RESTRICTED_ACCESS
ADD CONSTRAINT  AH108_PK PRIMARY KEY (HRSR_REQUEST_CD,EMPLOYEE_PIN,DATE_RESTRICTED_START_DTE);

ALTER TABLE AH108_HRSR_RESTRICTED_ACCESS
ADD CONSTRAINT AH108_AH027_FK FOREIGN KEY (HRSR_REQUEST_CD) REFERENCES AH027_HRSR_REQUEST (RQT_HRSR_REQUEST_CD);


CREATE OR REPLACE PUBLIC SYNONYM AH108_HRSR_RESTRICTED_ACCESS FOR TIPS.AH108_HRSR_RESTRICTED_ACCESS;

GRANT SELECT ON AH108_HRSR_RESTRICTED_ACCESS TO TIPSUSER;
GRANT SELECT, INSERT, UPDATE, DELETE ON AH108_HRSR_RESTRICTED_ACCESS TO EVERYTHING_IN_TIPS;

