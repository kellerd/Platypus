
CREATE TABLE AH107_HRSR_PROGRESS_TRACKER
(
    HRSR_PROGRESS_TRACKER_ID NUMBER NOT NULL ,
    HRSR_REQUEST_CD      VARCHAR2(20) NOT NULL ,
    MILESTONE_CD         VARCHAR2(3) NOT NULL ,
    DATE_MILESTONE_MET_DTE DATE NOT NULL ,
    DATE_CREATED_DTE     DATE NULL ,
    DATE_LAST_UPDATE_DTE DATE NULL ,
    USER_LAST_UPDATE_ID  VARCHAR2(30) NULL ,
    DATE_DELETED_DTE     DATE NULL 
);

COMMENT ON TABLE AH107_HRSR_PROGRESS_TRACKER IS 'A table to capture milestones and their dates completed for an HRSR. This data will be used to produce a progress tracker bar on the HRSR application and for HR reports. ';

COMMENT ON COLUMN AH107_HRSR_PROGRESS_TRACKER.HRSR_PROGRESS_TRACKER_ID IS 'Unique, sequence generated ID of the record. ';

COMMENT ON COLUMN AH107_HRSR_PROGRESS_TRACKER.HRSR_REQUEST_CD IS 'Foreign key to AH027_HRSR_REQUEST. System generated Primary Key based on a defined algorithm in the following format: Year request started Hyphen (-) Sequential number';

COMMENT ON COLUMN AH107_HRSR_PROGRESS_TRACKER.MILESTONE_CD IS 'Foreign key to TH202_MILESTONE. A unique, system generated primary key of the record. ';

COMMENT ON COLUMN AH107_HRSR_PROGRESS_TRACKER.DATE_MILESTONE_MET_DTE IS 'Date the milestone was met for this HRSR.';

COMMENT ON COLUMN AH107_HRSR_PROGRESS_TRACKER.DATE_CREATED_DTE IS 'The date on which the data item was created and became available for use.';

COMMENT ON COLUMN AH107_HRSR_PROGRESS_TRACKER.DATE_LAST_UPDATE_DTE IS 'The date the data item was last updated.';

COMMENT ON COLUMN AH107_HRSR_PROGRESS_TRACKER.USER_LAST_UPDATE_ID IS 'The responsible user that affected the last change of the data record.';

COMMENT ON COLUMN AH107_HRSR_PROGRESS_TRACKER.DATE_DELETED_DTE IS 'The date from which the data item is no longer allowed to be referenced for any new inserts or updates.
This can only happen for the current day or previous dates.';

CREATE UNIQUE INDEX AH107_PK ON AH107_HRSR_PROGRESS_TRACKER
(HRSR_PROGRESS_TRACKER_ID   ASC);

CREATE INDEX AH107_IF1 ON AH107_HRSR_PROGRESS_TRACKER
(HRSR_REQUEST_CD   ASC);

CREATE INDEX AH107_IF2 ON AH107_HRSR_PROGRESS_TRACKER
(MILESTONE_CD   ASC);

CREATE TABLE TH202_MILESTONE
(
    MILESTONE_CD         VARCHAR2(3) NOT NULL ,
    MILESTONE_ENM        VARCHAR2(150) NOT NULL ,
    MILESTONE_FNM        VARCHAR2(150) NULL ,
    DATE_CREATED_DTE     DATE NULL ,
    DATE_LAST_UPDATE_DTE DATE NULL ,
    USER_LAST_UPDATE_ID  VARCHAR2(30) NULL ,
    DATE_DELETED_DTE     DATE NULL 
);

COMMENT ON COLUMN TH202_MILESTONE.MILESTONE_CD IS 'Unique, system generated primary key of the record. ';

COMMENT ON COLUMN TH202_MILESTONE.MILESTONE_ENM IS 'English name of the milestone';

COMMENT ON COLUMN TH202_MILESTONE.MILESTONE_FNM IS 'French name of the milestone';

COMMENT ON COLUMN TH202_MILESTONE.DATE_CREATED_DTE IS 'The date on which the data item was created and became available for use.';

COMMENT ON COLUMN TH202_MILESTONE.DATE_LAST_UPDATE_DTE IS 'The date the data item was last updated.';

COMMENT ON COLUMN TH202_MILESTONE.USER_LAST_UPDATE_ID IS 'The responsible user that affected the last change of the data record.';

COMMENT ON COLUMN TH202_MILESTONE.DATE_DELETED_DTE IS 'The date from which the data item is no longer allowed to be referenced for any new inserts or updates.
This can only happen for the current day or previous dates.';

CREATE UNIQUE INDEX TH202_PK ON TH202_MILESTONE
(MILESTONE_CD   ASC);

CREATE UNIQUE INDEX TH202_AK1 ON TH202_MILESTONE
(MILESTONE_ENM   ASC);

CREATE UNIQUE INDEX TH202_AK2 ON TH202_MILESTONE
(MILESTONE_FNM   ASC);

CREATE TABLE TH203_XREF_TH048_TH202
(
    ACT_ACTION_CD        VARCHAR2(2) NOT NULL ,
    MILESTONE_CD         VARCHAR2(3) NOT NULL ,
    DATE_CREATED_DTE     DATE NULL ,
    DATE_LAST_UPDATE_DTE DATE NULL ,
    USER_LAST_UPDATE_ID  VARCHAR2(30) NULL ,
    DATE_DELETED_DTE     DATE NULL 
);

COMMENT ON TABLE TH203_XREF_TH048_TH202 IS 'Cross reference table associating an HRSR action code (TH048_HRSR_ACTION_CODE) with a milestone (TH202_MILESTONE).';

COMMENT ON COLUMN TH203_XREF_TH048_TH202.ACT_ACTION_CD IS 'Foreign key to TH048_HRSR_ACTION_CODE. A sequence generated primary key that identifies the action record.Action options are dependant on the type of request.';

COMMENT ON COLUMN TH203_XREF_TH048_TH202.MILESTONE_CD IS 'Foreign key to TH202_MILESTONE. A unique, system generated primary key of the record. ';

COMMENT ON COLUMN TH203_XREF_TH048_TH202.DATE_CREATED_DTE IS 'The date on which the data item was created and became available for use.';

COMMENT ON COLUMN TH203_XREF_TH048_TH202.DATE_LAST_UPDATE_DTE IS 'The date the data item was last updated.';

COMMENT ON COLUMN TH203_XREF_TH048_TH202.USER_LAST_UPDATE_ID IS 'The responsible user that affected the last change of the data record.';

COMMENT ON COLUMN TH203_XREF_TH048_TH202.DATE_DELETED_DTE IS 'The date from which the data item is no longer allowed to be referenced for any new inserts or updates.
This can only happen for the current day or previous dates.';

CREATE UNIQUE INDEX TH203_PK ON TH203_XREF_TH048_TH202
(ACT_ACTION_CD   ASC,MILESTONE_CD   ASC);

CREATE INDEX TH203_IF1 ON TH203_XREF_TH048_TH202
(ACT_ACTION_CD   ASC);

CREATE INDEX TH203_IF2 ON TH203_XREF_TH048_TH202
(MILESTONE_CD   ASC);

ALTER TABLE AH107_HRSR_PROGRESS_TRACKER
ADD CONSTRAINT  AH107_PK PRIMARY KEY (HRSR_PROGRESS_TRACKER_ID);

ALTER TABLE TH202_MILESTONE
ADD CONSTRAINT  TH202_PK PRIMARY KEY (MILESTONE_CD);

ALTER TABLE TH202_MILESTONE
ADD CONSTRAINT  TH202_AK1 UNIQUE (MILESTONE_ENM);

ALTER TABLE TH202_MILESTONE
ADD CONSTRAINT  TH202_AK2 UNIQUE (MILESTONE_FNM);

ALTER TABLE TH203_XREF_TH048_TH202
ADD CONSTRAINT  TH203_PK PRIMARY KEY (ACT_ACTION_CD,MILESTONE_CD);

ALTER TABLE AH107_HRSR_PROGRESS_TRACKER
ADD CONSTRAINT AH107_AH027_FK FOREIGN KEY (HRSR_REQUEST_CD) REFERENCES AH027_HRSR_REQUEST (RQT_HRSR_REQUEST_CD);

ALTER TABLE AH107_HRSR_PROGRESS_TRACKER
ADD CONSTRAINT AH107_TH202_FK FOREIGN KEY (MILESTONE_CD) REFERENCES TH202_MILESTONE (MILESTONE_CD);

ALTER TABLE TH203_XREF_TH048_TH202
ADD CONSTRAINT TH203_TH048_FK FOREIGN KEY (ACT_ACTION_CD) REFERENCES TH048_HRSR_ACTION (ACT_ACTION_CD);

ALTER TABLE TH203_XREF_TH048_TH202
ADD CONSTRAINT TH203_TH202_FK FOREIGN KEY (MILESTONE_CD) REFERENCES TH202_MILESTONE (MILESTONE_CD);


CREATE OR REPLACE PUBLIC SYNONYM AH107_HRSR_PROGRESS_TRACKER FOR TIPS.AH107_HRSR_PROGRESS_TRACKER;
GRANT SELECT ON AH107_HRSR_PROGRESS_TRACKER TO tipsuser;
GRANT SELECT, INSERT, UPDATE, DELETE ON AH107_HRSR_PROGRESS_TRACKER TO everything_in_tips;

CREATE OR REPLACE PUBLIC SYNONYM TH202_MILESTONE FOR TIPS.TH202_MILESTONE;
GRANT SELECT ON TH202_MILESTONE TO tipsuser;
GRANT SELECT, INSERT, UPDATE, DELETE ON TH202_MILESTONE TO everything_in_tips;

CREATE OR REPLACE PUBLIC SYNONYM TH203_XREF_TH048_TH202 FOR TIPS.TH203_XREF_TH048_TH202;
GRANT SELECT ON TH203_XREF_TH048_TH202 TO tipsuser;
GRANT SELECT, INSERT, UPDATE, DELETE ON TH203_XREF_TH048_TH202 TO everything_in_tips;


